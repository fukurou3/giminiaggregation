âœ… Next.jsï¼ˆReactï¼‰ + Firebase é–‹ç™ºæŒ‡ç¤ºæ›¸ï¼ˆçˆ†é€Ÿ & å®‰å®šï¼‰
ğŸ— æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯
é …ç›®	æŠ€è¡“
ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰	Next.js (React) + TypeScriptï¼ˆTSXï¼‰
ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰	Firebase SDKï¼ˆAuth / Firestore / Storageï¼‰
çŠ¶æ…‹ç®¡ç†	Zustand ã¾ãŸã¯ React Contextï¼ˆReduxä¸è¦ï¼‰
ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³	zod + react-hook-formï¼ˆãƒ•ã‚©ãƒ¼ãƒ é€£æºï¼‰
ã‚¹ã‚¿ã‚¤ãƒªãƒ³ã‚°	Tailwind CSSï¼ˆæ¨å¥¨ï¼‰
ãƒ‡ãƒ—ãƒ­ã‚¤	ãƒ•ãƒ­ãƒ³ãƒˆï¼šVercel / ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ï¼šFirebase
SSR	ä½¿ç”¨ã—ãªã„ï¼ˆCSRã§çµ±ä¸€ï¼‰

ğŸ“ ## ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹æˆï¼ˆMVP ãƒ†ãƒ³ãƒ—ãƒ¬ï¼‰

```text
my-canvas-app/
â”œâ”€â”€ pages/ or app/            # Next.js ãƒšãƒ¼ã‚¸
â”‚   â”œâ”€â”€ index.tsx             # æŠ•ç¨¿ä¸€è¦§
â”‚   â”œâ”€â”€ new.tsx               # æŠ•ç¨¿ãƒ•ã‚©ãƒ¼ãƒ 
â”‚   â””â”€â”€ [id].tsx              # è©³ç´°ãƒšãƒ¼ã‚¸
â”œâ”€â”€ components/               # å†åˆ©ç”¨ UI éƒ¨å“
â”‚   â””â”€â”€ PostCard.tsx
â”œâ”€â”€ lib/                      # åˆæœŸåŒ–ãƒ»å…±é€šãƒ­ã‚¸ãƒƒã‚¯
â”‚   â”œâ”€â”€ firebase.ts           # SDK åˆæœŸåŒ–
â”‚   â”œâ”€â”€ auth.ts               # èªè¨¼å‡¦ç†
â”‚   â””â”€â”€ store.ts              # Zustand ã‚¹ãƒˆã‚¢
â”œâ”€â”€ types/                    # å‹å®šç¾©
â”‚   â””â”€â”€ Post.ts
â”œâ”€â”€ utils/                    # æ±ç”¨ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£
â”‚   â””â”€â”€ validate.ts           # zod ã‚¹ã‚­ãƒ¼ãƒ
â”œâ”€â”€ public/                   # é™çš„ãƒ•ã‚¡ã‚¤ãƒ«
â”œâ”€â”€ .env.local                # ç’°å¢ƒå¤‰æ•°
â”œâ”€â”€ .env.local.example        # å…±æœ‰ç”¨ã‚µãƒ³ãƒ—ãƒ«
â”œâ”€â”€ firebase.json             # Firebase è¨­å®šï¼ˆä»»æ„ï¼‰
â”œâ”€â”€ firestore.rules           # ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ«ãƒ¼ãƒ«
â””â”€â”€ README.md                 # ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ¦‚è¦
```

ğŸ§ ## å‹ã¨ã‚¹ã‚­ãƒ¼ãƒä¾‹

```ts
// types/Post.ts
import { Timestamp } from "firebase/firestore";
export type Post = {
  id: string;
  title: string;
  url: string;
  tags: string[];
  authorId: string;
  createdAt: Timestamp;
};

// lib/schemas/postSchema.ts
import { z } from "zod";
export const postSchema = z.object({
  title: z.string().min(1),
  url: z.string().url(),
  tags: z.array(z.string()),
});
```

---

## ã‚ˆãã‚ã‚‹ç½ ã¨å¯¾ç­–

1. **SDK åˆæœŸåŒ–ã®é‡è¤‡**ï¼ˆinitializeApp è¤‡æ•°å‘¼ã³å‡ºã—ï¼‰

   ```ts
   import { initializeApp, getApps, getApp } from "firebase/app";
   const app = getApps().length ? getApp() : initializeApp(config);
   ```
2. **ç’°å¢ƒå¤‰æ•°æœªè¨­å®š** (`NEXT_PUBLIC_` æ¥é ­è¾å¿˜ã‚Œ)

   * `.env.local` ã«å¿…ãš `NEXT_PUBLIC_FIREBASE_*` ã‚’å®šç¾©ã—ã€`.env.local.example` ã‚’å…±æœ‰
3. **NoSQL ã‚¹ã‚­ãƒ¼ãƒãƒ¬ã‚¹åœ°ç„**

   * zod ã‚¹ã‚­ãƒ¼ãƒã§ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ â†’ react-hook-form ã¨çµ±åˆ
4. **èªè¨¼çŠ¶æ…‹ã®ã¡ã‚‰ã¤ã**

   ```ts
   const [user, loading] = useAuthState(auth);
   if (loading) return <Spinner />;
   if (!user) return <Login />;
   ```
5. **Firebase Auth ã® SSR éå¯¾å¿œ**

   * `getServerSideProps` ã‚„ SSR ã¯ä½¿ã‚ãšå®Œå…¨ CSR
6. **Hosting ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ç ´ç¶»**

   * Vercel ã§ãƒ›ã‚¹ãƒˆã—ã€firebase.json rewrites ã¯ä¸è¦
7. **æœ¬ç•ªç’°å¢ƒã§æ­»ã¬åŸå› **

   * `.env.local` æœªè¨­å®šã€ãƒ«ãƒ¼ãƒ«æœªå®šç¾© â†’ `firestore.rules` ã‚’å¿…ãšç”¨æ„

---

## é–‹ç™º 7 ãƒ¶æ¡

1. `lib/firebase.ts` ã«åˆæœŸåŒ–ã‚’ä¸€å…ƒåŒ–
2. ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆç’°å¢ƒå¤‰æ•°ã¯å¿…ãš `NEXT_PUBLIC_` ã§
3. ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã¯ zod + react-hook-form
4. Auth çŠ¶æ…‹ã¯ `useAuthState()` + Zustand ã§ç®¡ç†
5. SSR ã‚’ã‚„ã‚‰ãªã„ï¼ˆCSR çµ±ä¸€ï¼‰
6. Firebase Hosting ã§ã¯ãªã Vercel ã‚’ä½¿ã†
7. `.env.local.example` ã¨ `firestore.rules` ã¯å¿…é ˆ

---

## èªè¨¼ãƒ»æŠ•ç¨¿ä¾‹

```ts
// lib/auth.ts
import { GoogleAuthProvider, signInWithPopup } from "firebase/auth";
export const loginWithGoogle = async () => {
  const provider = new GoogleAuthProvider();
  await signInWithPopup(auth, provider);
};

// æŠ•ç¨¿ç™»éŒ²
import { db } from "@/lib/firebase";
import { collection, addDoc, serverTimestamp } from "firebase/firestore";
await addDoc(collection(db, "posts"), {
  title,
  url,
  tags,
  createdAt: serverTimestamp(),
  authorId: user.uid,
});
```

---

## æœ€çµ‚è£œè¶³ï¼šãƒ¡ãƒªãƒƒãƒˆ

* ğŸ¯ **MVP æœ€é©åŒ–**: é€Ÿæ”»æ§‹ç¯‰ã§è¿·ã„ãªãä¸€äººå®Œçµ
* ğŸ” **å®‰å…¨æ€§**: å‹ãƒ»èªè¨¼ãƒ»ãƒ«ãƒ¼ãƒ«ã§å …ç‰¢
* ğŸ“¦ **å°†æ¥å±•é–‹**: Flutter/React Native/SSR ç§»è¡Œå®¹æ˜“
* ğŸŒ **ç°¡æ˜“ãƒ‡ãƒ—ãƒ­ã‚¤**: Vercel Ã— Firebase ã§ãƒ¯ãƒ³ã‚¯ãƒªãƒƒã‚¯å…¬é–‹
